C51 COMPILER V9.60.0.0   MAIN                                                              02/17/2022 10:19:43 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\keil_C51\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /**************************************************************************************
   2          å®éªŒç°è±¡ï¼šä¸‹è½½ç¨‹åºåæ•°ç ç®¡å4ä½æ˜¾ç¤º0ï¼ŒæŒ‰K1ä¿å­˜æ˜¾ç¤ºçš„æ•°æ®ï¼ŒæŒ‰K2è¯»å–ä¸Šæ¬¡ä¿å
             -­˜çš„æ•°æ®ï¼Œ
   3                æŒ‰K3æ˜¾ç¤ºæ•°æ®åŠ ä¸€ï¼ŒæŒ‰K4æ˜¾ç¤ºæ•°æ®æ¸…é›¶ã€‚æœ€å¤§èƒ½å†™å…¥çš„æ•°æ®æ˜¯255
   4                
   5          æ¥çº¿è¯´æ˜ï¼š (å…·ä½“æ¥çº¿å›¾å¯è§å¼€å‘æ”»ç•¥å¯¹åº”å®éªŒçš„â€œå®éªŒç°è±¡â€ç« èŠ‚)
   6                
   7            
   8          æ³¨æ„äº‹é¡¹ï¼š                                         
   9          ***************************************************************************************/
  10          
  11          #include "reg52.h"       //æ­¤æ–‡ä»¶ä¸­å®šä¹‰äº†å•ç‰‡æœºçš„ä¸€äº›ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨
  12          #include "i2c.h"  
  13          
  14          typedef unsigned int u16;   //å¯¹æ•°æ®ç±»å‹è¿›è¡Œå£°æ˜å®šä¹‰
  15          typedef unsigned char u8;
  16          
  17          sbit LSA=P2^2;
  18          sbit LSB=P2^3;
  19          sbit LSC=P2^4;
  20          
  21          sbit k1=P3^1;
  22          sbit k2=P3^0;
  23          sbit k3=P3^2;
  24          sbit k4=P3^3;  //å®šä¹‰æŒ‰é”®ç«¯å£
  25          
  26          char num=0;
  27          u8 disp[4];
  28          u8 code smgduan[10]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};
  29          
  30          /*******************************************************************************
  31          * å‡½ æ•° å         : delay
  32          * å‡½æ•°åŠŸèƒ½       : å»¶æ—¶å‡½æ•°ï¼Œi=1æ—¶ï¼Œå¤§çº¦å»¶æ—¶10us
  33          *******************************************************************************/
  34          void delay(u16 i)
  35          {
  36   1        while(i--); 
  37   1      }
  38          
  39          
  40          /*******************************************************************************
  41          * å‡½æ•°å         :Keypros()
  42          * å‡½æ•°åŠŸèƒ½     :æŒ‰é”®å¤„ç†å‡½æ•°
  43          * è¾“å…¥           : æ— 
  44          * è¾“å‡º           : æ— 
  45          *******************************************************************************/
  46          void Keypros()
  47          {
  48   1        if(k1==0)
  49   1        {
  50   2          delay(1000);  //æ¶ˆæŠ–å¤„ç†
  51   2          if(k1==0)
  52   2          {
  53   3            At24c02Write(1,num);   //åœ¨åœ°å€1å†…å†™å…¥æ•°æ®num
C51 COMPILER V9.60.0.0   MAIN                                                              02/17/2022 10:19:43 PAGE 2   

  54   3          }
  55   2          while(!k1);
  56   2        }
  57   1        if(k2==0)
  58   1        {
  59   2          delay(1000);  //æ¶ˆæŠ–å¤„ç†
  60   2          if(k2==0)
  61   2          {
  62   3            num=At24c02Read(1);   //è¯»å–EEPROMåœ°å€1å†…çš„æ•°æ®ä¿å­˜åœ¨numä¸­
  63   3          }
  64   2          while(!k2);
  65   2        }
  66   1        if(k3==0)
  67   1        {
  68   2          delay(100);  //æ¶ˆæŠ–å¤„ç†
  69   2          if(k3==0)
  70   2          {
  71   3            num++;     //æ•°æ®åŠ 1
  72   3            if(num>255)num=0;
  73   3          }
  74   2          while(!k3);
  75   2        }
  76   1        if(k4==0)
  77   1        {
  78   2          delay(1000);  //æ¶ˆæŠ–å¤„ç†
  79   2          if(k4==0)
  80   2          {
  81   3            num=0;     //æ•°æ®æ¸…é›¶
  82   3          }
  83   2          while(!k4);
  84   2        }   
  85   1      }
  86          
  87          /*******************************************************************************
  88          * å‡½æ•°å         :datapros()
  89          * å‡½æ•°åŠŸèƒ½     :æ•°æ®å¤„ç†å‡½æ•°
  90          * è¾“å…¥           : æ— 
  91          * è¾“å‡º           : æ— 
  92          *******************************************************************************/
  93          void datapros()
  94          {
  95   1        disp[0]=smgduan[num/1000];//åƒä½
  96   1        disp[1]=smgduan[num%1000/100];//ç™¾ä½
  97   1        disp[2]=smgduan[num%1000%100/10];//ä¸ªä½
  98   1        disp[3]=smgduan[num%1000%100%10];   
  99   1      }
 100          
 101          
 102          /*******************************************************************************
 103          * å‡½æ•°å         :DigDisplay()
 104          * å‡½æ•°åŠŸèƒ½     :æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°
 105          * è¾“å…¥           : æ— 
 106          * è¾“å‡º           : æ— 
 107          *******************************************************************************/
 108          void DigDisplay()
 109          {
 110   1        u8 i;
 111   1        for(i=0;i<4;i++)
 112   1        {
 113   2          switch(i)  //ä½é€‰ï¼Œé€‰æ‹©ç‚¹äº®çš„æ•°ç ç®¡ï¼Œ
 114   2          {
 115   3            case(0):
C51 COMPILER V9.60.0.0   MAIN                                                              02/17/2022 10:19:43 PAGE 3   

 116   3              LSA=1;LSB=1;LSC=0; break;//æ˜¾ç¤ºç¬¬0ä½
 117   3            case(1):
 118   3              LSA=0;LSB=1;LSC=0; break;//æ˜¾ç¤ºç¬¬1ä½
 119   3            case(2):
 120   3              LSA=1;LSB=0;LSC=0; break;//æ˜¾ç¤ºç¬¬2ä½
 121   3            case(3):
 122   3              LSA=0;LSB=0;LSC=0; break;//æ˜¾ç¤ºç¬¬3ä½
 123   3          }
 124   2          P0=disp[i];//å‘é€æ•°æ®
 125   2          delay(100); //é—´éš”ä¸€æ®µæ—¶é—´æ‰«æ  
 126   2          P0=0x00;//æ¶ˆéš
 127   2        }   
 128   1      }
 129          
 130          /*******************************************************************************
 131          * å‡½ æ•° å       : main
 132          * å‡½æ•°åŠŸèƒ½     : ä¸»å‡½æ•°
 133          * è¾“    å…¥       : æ— 
 134          * è¾“    å‡º       : æ— 
 135          *******************************************************************************/
 136          void main()
 137          { 
 138   1        while(1)
 139   1        {
 140   2          Keypros();   //æŒ‰é”®å¤„ç†å‡½æ•°
 141   2          datapros();  //æ•°æ®å¤„ç†å‡½æ•°
 142   2          DigDisplay();//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°    
 143   2        }   
 144   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    325    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
